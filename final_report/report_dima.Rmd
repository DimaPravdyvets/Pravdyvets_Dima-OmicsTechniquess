---
title: "Final Microarray data analysis done by Dmytro Pravdyvets"
output: html_document
---
# Project summary
This is the final project of the second part of the course of Omics carried out by Alex Sanchez Pla, where the main goal is maily how to analyse Microarray data, learn how to obtain it and leaning how to use R and Rmd. The project consists of a report of an analysis of Microaray data of choice, which in my case is GSE114556. 

## Summary of the data 	
The obligate intracellular bacterium Chlamydia trachomatis replicates in a cytosolic vacuole in human epithelial cells. Infection of human cells with C. trachomatis causes substantial changes to many host cell signalling pathways but the molecular basis of such influence is not well understood. Studies of gene transcription of the infected cell have shown altered transcription of many host cell genes, indicating a transcriptional response of the host cell to the infection. We here describe that infection of human cells with C. trachomatis as well as infection of murine cells with C. muridarum profoundly inhibits protein synthesis of the infected host cell. This inhibition was accompanied by changes to the ribosomal profile of the infected cell indicative of a block of translation initiation, most likely as part of a stress response. The chlamydial protease CPAF also reduced protein synthesis in uninfected cells although CPAF-deficient C. trachomatis showed no defect in this respect. Analysis of polysomal mRNA as a proxy of actively transcribed mRNA identified a number of biological processes differentially affected by chlamydial infection. Mapping of differentially regulated genes onto a protein interaction network identified nodes of up- and down-regulated networks during chlamydial infection. Proteomic analysis of protein synthesis further suggested translational regulation of host cell functions by chlamydial infection. These results demonstrate reprogramming of the host cell during chlamydial infection through the alteration of protein synthesis.
 	
## Overall design	
HeLa cells were infected with C. trachomatis L2 for 33h or left untreated and polysomal as well as total RNA was isolated.

## Citations
Ohmer M, Tzivelekidis T, Niedenf√ºhr N, Volceanov-Hahn L et al. Infection of HeLa cells with Chlamydia trachomatis inhibits protein synthesis and causes multiple changes to host cell pathways. Cell Microbiol 2019 Apr;21(4):e12993. PMID: 30551267


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
Loading all the needed packages before running the analysis
```{r, include=FALSE}
if (!require(BiocManager)) install.packages("BiocManager")

installifnot <- function (pkg){
  if (!require(pkg, character.only=T)){
    BiocManager::install(pkg)
}else{
  require(pkg, character.only=T)
  }
}

installifnot("pd.mogene.1.0.st.v1")
installifnot("mogene10sttranscriptcluster.db")
installifnot("oligo")
installifnot("limma")
installifnot("Biobase")
installifnot("arrayQualityMetrics")
installifnot("genefilter")
installifnot("multtest")
installifnot("annotate")
installifnot("xtable")
installifnot("gplots")
installifnot("scatterplot3d")
```
#### targets summary
We can see that the whole grou of observation can be divided into 12 samples, that can be grouped into 4 different subgroups, the division into subgroups will be later used as factors for regression model
```{r}
targets <- read.csv('./data/targets.csv', header = T,sep = ';')
targets
```
```{r,include=FALSE}
workingDir <-getwd()
dataDir <- file.path(workingDir, "data")
resultsDir <- file.path(workingDir, "results")
setwd(resultsDir)
```
Loadign all the CEL files of the study that will be used for the analysis
```{r}
CELfiles <- list.celfiles(file.path(dataDir))
rawData <- read.celfiles(file.path(dataDir,CELfiles))

```
Defining 2 varaibles of the targets file that will be used for plots later on
```{r}
sampleNames <- as.character(targets$ShortNAme)
sampleColor <- as.character(targets$Colors)
```
### Quality control of arrays with raw data
We begin to analyse data with a boxplot 
```{r}
boxplot(rawData, which="all",las=2, main="Intensity distribution of RAW data", 
        cex.axis=0.6, col=sampleColor, names=sampleNames)
```
We can see that there not seem to be any artifacts with the data, but the distribution of the values seems to be somewhat different between the groups.

Next step would be to cluster the data
```{r}
clust.euclid.average <- hclust(dist(t(exprs(rawData))),method="average")
plot(clust.euclid.average, labels=sampleNames, main="Hierarchical clustering of RawData", 
     cex=0.7,  hang=-1,)
```
It looks like there are some clear clusters of data if we compare the clusters to the boxplots, similar boxplot end up in the same cluster ex(69,72,73).

Now we do the principar component analysis

